import { useState, useEffect } from 'react'
import { Button } from "/components/ui/button"
import { Card, CardContent, CardHeader, CardTitle } from "/components/ui/card"
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "/components/ui/select"
export default function CookingAssistant() {
  const [currentStep, setCurrentStep] = useState(0)
  const [recipes, setRecipes] = useState([
    {
      title: 'Grilled Chicken with Vegetables',
      steps: [
        'Preheat grill to medium-high heat.',
        'Season chicken with salt, pepper, and your favorite herbs.',
        'Grill chicken for 5-6 minutes per side, or until cooked through.',
        'Grill vegetables for 3-4 minutes per side, or until tender.',
        'Serve hot and enjoy!',
      ],
    },
    {
      title: 'Spaghetti Bolognese',
      steps: [
        'Cook spaghetti in boiling water until al dente.',
        'Heat olive oil in a large saucepan over medium heat.',
        'Add onion, garlic, and ground beef. Cook until browned.',
        'Add tomato sauce, salt, and pepper. Simmer for 10-15 minutes.',
        'Serve spaghetti with bolognese sauce and parmesan cheese.',
      ],
    },
    {
      title: 'Roasted Chicken with Potatoes',
      steps: [
        'Preheat oven to 425°F (220°C).',
        'Season chicken with salt, pepper, and your favorite herbs.',
        'Roast chicken in the oven for 45-50 minutes, or until cooked through.',
        'Toss potatoes with olive oil, salt, and pepper. Roast in the oven for 20-25 minutes, or until tender.',
        'Serve hot and enjoy!',
      ],
    },
    {
    title: 'vegetable soup',
    steps: [
       'carrots,celery,tomatoes,potatoes,green beans,corn,peas,yellow onion and garlic'
       'At first cut those vegetables and then wash those vegetables'
       'Then cook those vegetables'
       'Cook until veggies are tender on high heat for about 3 hours or low heat for about 6 – 7 hours'
       'Add peas and corn during the last 30 minutes'
       'Use your instant pot to saute your aromatics and then add all other vegetables to the pressure cooker'
       'Be sure to securely lock the lid, then use the manual valve to release pressure when done'
       'Serve hot and enjoy!',
       ],
     },
    {
      title: 'Veggie Stir-Fry',
      steps: [
        'Heat olive oil in a large skillet or wok over medium-high heat.',
        'Add your favorite vegetables (e.g., broccoli, bell peppers, carrots). Cook until tender.',
        'Add soy sauce, garlic, and ginger. Stir-fry for 1-2 minutes.',
        'Serve hot over rice or noodles.',
        'Enjoy your delicious veggie stir-fry!',
      ],
    },
    {
      title 'Grilled Salmon Tacos',
      steps: [
        'Marinated Salmon'
        '1 tablespoon light brown sugar,1/4 teaspoon ground white pepper,1/3 cup chopped cilantro,1/3 cup reduced-sodium soy sauce,1 tablespoon oyster sauce,1 garlic clove, pressed,2 pounds skinless salmon fillets, cut into 1-inch cubes'
        'Tacos'
        '4 skewers,1 green bell pepper, cut into 2 inch pieces,1 red bell pepper, cut into 2 inch pieces,1/2 red onion, cut into wedges,10 (8 inch) flour tortillas, warmed,1 1/2 cups prepared coleslaw,1/2 mini seedless cucumber, thinly sliced,2 radishes, thinly sliced,1 green onion, thinly sliced (optional)'
        'Mix light brown sugar, white pepper, cilantro, soy sauce, oyster sauce, and garlic together in a bowl. Add salmon and marinate for 15 minutes'
        'Preheat an outdoor grill for medium heat and lightly oil the grate'
        'Beginning and ending with salmon, thread salmon, green pepper, red pepper, and red onions onto 4 skewers'
        'Cook salmon skewers on the hot grill until fish is opaque in color, turning every 5 minutes, about 15 minutes total'
        'To each tortilla add coleslaw, cucumbers, and radishes and top with salmon. Garnish with sliced green onions'
      ],
     },
])
  const [currentRecipeIndex, setCurrentRecipeIndex] = useState(0)
  const [listening, setListening] = useState(false)
  const [speechRecognition, setSpeechRecognition] = useState(null)
  const [voiceReply, setVoiceReply] = useState('')
  useEffect(() => {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition
    const recognition = new SpeechRecognition()
    recognition.onstart = () => {
      setListening(true)
    }
    recognition.onresult = (event) => {
      const transcript = event.results[0][0].transcript
      handleVoiceCommand(transcript)
    }
    recognition.onerror = (event) => {
      console.error('Error occurred while recognizing speech:', event)
    }
    recognition.onend = () => {
      setListening(false)
    }
    recognition.lang = 'en-US'
    recognition.maxResults = 10
    recognition.continuous = false
    recognition.interimResults = false
    setSpeechRecognition(recognition)
  }, [])
  const handleRecipeChange = (index: number) => {
    setCurrentRecipeIndex(index)
    setCurrentStep(0)
  }
  const handleVoiceCommand = (transcript: string) => {
    transcript = transcript.toLowerCase()
    if (transcript.includes('next')) {
      setCurrentStep((prevStep) => Math.min(prevStep + 1, recipes[currentRecipeIndex].steps.length - 1))
      setVoiceReply('Moving to the next step.')
    } else if (transcript.includes('previous')) {
      setCurrentStep((prevStep) => Math.max(prevStep - 1, 0))
      setVoiceReply('Moving to the previous step.')
    } else if (transcript.includes('change recipe')) {
      setCurrentRecipeIndex((prevIndex) => (prevIndex + 1) % recipes.length)
      setCurrentStep(0)
      setVoiceReply('Changing to a new recipe.')
    } else if (transcript.includes('what is the current step')) {
      setVoiceReply(`The current step is ${currentStep + 1} of ${recipes[currentRecipeIndex].steps.length}.`)
    } else if (transcript.includes('what is the current recipe')) {
      setVoiceReply(`The current recipe is ${recipes[currentRecipeIndex].title}.`)
    } else {
      setVoiceReply('Sorry, I did not understand that command.')
    }
    const speechSynthesis = window.speechSynthesis
    const speech = new SpeechSynthesisUtterance(voiceReply)
    speech.lang = 'en-US'
    speechSynthesis.speak(speech)
  }
  const startListening = () => {
    if (speechRecognition && !listening) {
      speechRecognition.start()
      setListening(true)
    }
  }
  return (
    <Card className="w-full max-w-md mx-auto">
      <CardHeader>
        <CardTitle className="text-2xl font-bold">{recipes[currentRecipeIndex].title}</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="text-lg font-bold mb-4">Step {currentStep + 1} of {recipes[currentRecipeIndex].steps.length}</div>
        <div className="text-lg mb-4">{recipes[currentRecipeIndex].steps[currentStep]}</div>
        <div className="flex space-x-2">
          <Button onClick={() => setCurrentStep((prevStep) => Math.max(prevStep - 1, 0))}>Previous</Button>
          <Button onClick={() => setCurrentStep((prevStep) => Math.min(prevStep + 1, recipes[currentRecipeIndex].steps.length - 1))}>Next</Button>
        </div>
        <div className="flex flex-wrap justify-center gap-4 mt-4">
          {recipes.map((recipe, index) => (
            <Button key={recipe.title} onClick={() => handleRecipeChange(index)} className="w-40 h-12">{recipe.title}</Button>
          ))}
        </div>
        <Button onClick={startListening} className="mt-4">{listening ? 'Stop Listening' : 'Click to start listening'}</Button>
        <div className="text-lg font-bold mt-4">Voice Reply: {voiceReply}</div>
      </CardContent>
    </Card>
  )

}
